
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="index, follow" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://ineed.to/theme/stylesheet/style.min.css">

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
          media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
    href="https://ineed.to/theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
          href="https://ineed.to/theme/pygments/stata-dark.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: light)"
          href="https://ineed.to/theme/pygments/solarized-light.min.css">



  <link rel="stylesheet" type="text/css" href="https://ineed.to/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://ineed.to/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://ineed.to/theme/font-awesome/css/solid.css">


  <link rel="shortcut icon" href="https://ineed.to/images/favicon.ico" type="image/x-icon">
  <link rel="icon" href="https://ineed.to/images/favicon.ico" type="image/x-icon">

  <!-- Chrome, Firefox OS and Opera -->
  <meta name="theme-color" content="#333">
  <!-- Windows Phone -->
  <meta name="msapplication-navbutton-color" content="#333">
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Microsoft EDGE -->
  <meta name="msapplication-TileColor" content="#333">

  <link href="https://ineed.to/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="iNeed.to Atom">

  <link href="https://ineed.to/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="iNeed.to RSS">


 

<meta name="author" content="Bitpusher" />
<meta name="description" content="The best presentation on business email compromise investigation I&#39;ve seen in years" />
<meta name="keywords" content="article, m365, bec, investigation, logs, incident, response, scripting">


  <meta property="og:site_name" content="iNeed.to"/>
  <meta property="og:title" content="M365 BEC investigation easy as Cake"/>
  <meta property="og:description" content="The best presentation on business email compromise investigation I&#39;ve seen in years"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="https://ineed.to/bec-cake/"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2025-10-15 19:30:00-07:00"/>
  <meta property="article:modified_time" content="2025-10-15 19:30:00-07:00"/>
  <meta property="article:author" content="https://ineed.to/author/bitpusher.html">
  <meta property="article:section" content="code"/>
  <meta property="article:tag" content="article"/>
  <meta property="article:tag" content="m365"/>
  <meta property="article:tag" content="bec"/>
  <meta property="article:tag" content="investigation"/>
  <meta property="article:tag" content="logs"/>
  <meta property="article:tag" content="incident"/>
  <meta property="article:tag" content="response"/>
  <meta property="article:tag" content="scripting"/>
  <meta property="og:image" content="https://ineed.to/images/fox.png">

  <title>iNeed.to &ndash; M365 BEC investigation easy as Cake</title>


</head>
<body >

<aside>
  <div>
    <a href="https://ineed.to/">
      <img src="https://ineed.to/images/fox.png" alt="iNeed.to" title="iNeed.to">
    </a>

    <h1>
      <a href="https://ineed.to/">iNeed.to</a>
    </h1>

    <p>Seeking the wholeness of the integrated person. Technology - Martial Arts - Learning</p>


    <nav>
      <ul class="list">



          <li>
            <a target="_self" href="https://ineed.to/index.html" >Home</a>
          </li>
          <li>
            <a target="_self" href="https://ineed.to/fixmypc/index.html" >theTechRelay.com</a>
          </li>
          <li>
            <a target="_self" href="https://ineed.to/fixmypc/index.html" >iNeed.to/fixmypc</a>
          </li>
          <li>
            <a target="_self" href="https://ineed.to/code/index.html" >iNeed.to/code</a>
          </li>
          <li>
            <a target="_self" href="https://ineed.to/fight/index.html" >iNeed.to/fight</a>
          </li>
          <li>
            <a target="_self" href="https://ineed.to/categories.html" >Categories</a>
          </li>
          <li>
            <a target="_self" href="https://ineed.to/archives.html" >Archives</a>
          </li>
          <li>
            <a target="_self" href="https://ineed.to/tags.html" >All Tags</a>
          </li>
          <li>
            <a target="_self" href="https://ineed.to/about/index.html" >About</a>
          </li>
          <li>
            <a target="_self" href="https://ineed.to/contact/index.html" >Contact</a>
          </li>
      </ul>
    </nav>

    <ul class="social">
      <li>
        <a class="sc-envelope"
rel="me"           href="https://ineed.to/pages/contact.html"
           target="_blank">
          <i class="fa-solid fa-envelope"></i>
        </a>
      </li>
      <li>
        <a class="sc-linkedin"
           href="https://www.linkedin.com/in/vmike/"
           target="_blank">
          <i class="fa-brands fa-linkedin"></i>
        </a>
      </li>
      <li>
        <a class="sc-github"
           href="https://github.com/bitpusher2k"
           target="_blank">
          <i class="fa-brands fa-github"></i>
        </a>
      </li>
      <li>
        <a class="sc-x-twitter"
           href="https://x.com/VinceVulpes/"
           target="_blank">
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      </li>
      <li>
        <a class="sc-discord"
           href="https://discordapp.com/users/370020594353438720"
           target="_blank">
          <i class="fa-brands fa-discord"></i>
        </a>
      </li>
      <li>
        <a class="sc-signal-messenger"
           href="https://signal.me/#eu/fhL_n_BFwvyodTKNGtfle5qfhYds-m04I73nmEuTg5qkzbzphYZNgJgY65JmA-s0"
           target="_blank">
          <i class="fa-brands fa-signal-messenger"></i>
        </a>
      </li>
      <li>
        <a class="sc-whatsapp"
           href="https://wa.me/qr/477GNRNN3OEVH1"
           target="_blank">
          <i class="fa-brands fa-whatsapp"></i>
        </a>
      </li>
      <li>
        <a class="sc-telegram"
           href="https://t.me/Bitpusher2k"
           target="_blank">
          <i class="fa-brands fa-telegram"></i>
        </a>
      </li>
      <li>
        <a class="sc-mastodon"
rel="me"           href="https://defcon.social/@bitpusher"
           target="_blank">
          <i class="fa-brands fa-mastodon"></i>
        </a>
      </li>
      <li>
        <a class="sc-rss"
           href="https://ineed.to/feeds/all.atom.xml"
           target="_blank">
          <i class="fa-solid fa-rss"></i>
        </a>
      </li>
    </ul>
  </div>

</aside>
  <main>


<article class="single">
  <header>
      
    <h1 id="bec-cake">M365 BEC investigation easy as Cake</h1>
    <p>
      Posted on 2025-10-15 in <a href="https://ineed.to/category/code.html">code</a>

    </p>
  </header>


  <div>
    <h1>Business email compromise investigation</h1>
<p>By far the most common type of impactful security incident is the business email compromise, or "BEC" - and the most common platform for a BEC is M365. After a threat actor gains access to someone's email account there are a number of nefarious and damaging things they can do - including sending malicious spam out from the account, hijacking email conversations, and instigating wire fraud by redirecting payments.</p>
<p>The best presentation I've seen on how to investigate these incidents in a long time was recently uploaded to YouTube. It's by Patterson Cake - an expirenced incident responder who emphasizes simplicity, effectiveness, and repeatability in his workflows:</p>
<p>Business Email Compromise Detect, Respond, &amp; Prevent w/ Patterson Cake</p>
<div style=" position: relative; padding-bottom: 56.25%;">
<iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" frameborder="0" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/NoIeluVIEeE" style="border: 1; top: 0; left: 0; width: 100%; height: 100%; position: absolute;" title="Business Email Compromise Detect, Respond, &amp; Prevent w/ Patterson Cake">
</iframe>
</div>
<p>Investigating &amp; responding to M365 BEC is a bit technical - this information will be of most benefit to those already somewhat familiar with email, M365 administration, Excel, etc..</p>
<p><a href="https://www.blackhillsinfosec.com/wp-content/uploads/2025/10/SLIDES_BEC-Preven-Detect-Respond-Webcast-109022025.pdf">Slides are available here</a> and Patterson has scripts to support BEC investigation on his GitHub at <a href="https://github.com/secure-cake/m365-bec-resources">https://github.com/secure-cake/m365-bec-resources</a>.</p>
<h1>And more BEC investigation scripts</h1>
<p>If you're still here you may be interested in more resources for M365 BEC, and as it happens I've written a number of scripts that support various aspects of M365 BEC incident response and investigation - all are available at <a href="https://github.com/bitpusher2k/M365IRScripts">https://github.com/bitpusher2k/M365IRScripts</a>.</p>
<p><img alt="The macro ribbon" src="./../images/article-beccake-irscripts.png" style="width: 1183px; height: auto;"/></p>
<p>These scripts are targeted and SMB/SME incident response, where more sophisticated enterprise tools such as Microsoft Sentinel or other SIEM are not available. All require only administrative access to the M365 tenant, and the installation of a few PowerShell modules. Overview of BEC response &amp; investigation process is in the <a href="https://github.com/bitpusher2k/M365IRScripts/blob/main/README.md">ReadMe</a>. Again, a certain level of familiarity with M365 and PowerShell will be needed to get the most out of this repository.</p>
<p>Of particular utility for manual investigation of incidents for me are 05-ProcessUnifiedAuditLogFlatten.ps1 which flattens out the blob of JSON data in a CSV export from the Unified Audit Log, and 06-Lookup-IPInfoCSV.ps1 which takes IP addresses from a column in a CSV and adds geolocation, ISP, and other valuable information (based on the service selected to look it up online).</p>
<p>Feel free to reach out to me with any feedback or questions.</p>
<p>Walk on,</p>
<div class="highlight"><pre><span></span><code> \`._,'/
 (_- -_)
   \o/
</code></pre></div>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://ineed.to/tag/article.html">article</a>
      <a href="https://ineed.to/tag/m365.html">m365</a>
      <a href="https://ineed.to/tag/bec.html">bec</a>
      <a href="https://ineed.to/tag/investigation.html">investigation</a>
      <a href="https://ineed.to/tag/logs.html">logs</a>
      <a href="https://ineed.to/tag/incident.html">incident</a>
      <a href="https://ineed.to/tag/response.html">response</a>
      <a href="https://ineed.to/tag/scripting.html">scripting</a>
    </p>
  </div>






</article>

<footer>
<p>
  &copy; 2025 Bitpusher - the Digital Fox - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nd/4.0/deed.en_US" target="_blank">Creative Commons Attribution-NoDerivs</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script id="dark-theme-script"
          src="https://ineed.to/theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="True"
          data-default-theme="dark"
          type="text/javascript">
  </script>
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-nd/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by-nd/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p><p>
  <script data-goatcounter="https://bitpusher.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
  <script async data-id="101489478" src="//static.getclicky.com/js"></script>
</p></footer>  </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " iNeed.to ",
  "url" : "https://ineed.to",
  "image": "https://ineed.to/images/fox.png",
  "description": "Sharing my passion for technology through consulting & scripting, martial arts through teaching, and learning/growth through chronicling my journey"
}
</script>
</body>
</html>