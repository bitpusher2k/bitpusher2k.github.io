
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="index, follow" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://ineed.to/theme/stylesheet/style.min.css">

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
          media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
    href="https://ineed.to/theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
          href="https://ineed.to/theme/pygments/stata-dark.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: light)"
          href="https://ineed.to/theme/pygments/solarized-light.min.css">



  <link rel="stylesheet" type="text/css" href="https://ineed.to/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://ineed.to/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://ineed.to/theme/font-awesome/css/solid.css">


  <link rel="shortcut icon" href="https://ineed.to/images/favicon.ico" type="image/x-icon">
  <link rel="icon" href="https://ineed.to/images/favicon.ico" type="image/x-icon">

  <!-- Chrome, Firefox OS and Opera -->
  <meta name="theme-color" content="#333">
  <!-- Windows Phone -->
  <meta name="msapplication-navbutton-color" content="#333">
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Microsoft EDGE -->
  <meta name="msapplication-TileColor" content="#333">

  <link href="https://ineed.to/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="iNeed.to Atom">

  <link href="https://ineed.to/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="iNeed.to RSS">


 

<meta name="author" content="Bitpusher" />
<meta name="description" content="Adding a few simple macros to the Excel ribbon can greatly enhance functionality &amp; speed common tasks" />
<meta name="keywords" content="article, excel, macro, logs, formatting, incident, response, ribbon">


  <meta property="og:site_name" content="iNeed.to"/>
  <meta property="og:title" content="Excel Macro Set"/>
  <meta property="og:description" content="Adding a few simple macros to the Excel ribbon can greatly enhance functionality &amp; speed common tasks"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="https://ineed.to/excel-macros/"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2024-05-20 19:30:00-07:00"/>
  <meta property="article:modified_time" content="2025-02-20 19:30:00-08:00"/>
  <meta property="article:author" content="https://ineed.to/author/bitpusher.html">
  <meta property="article:section" content="Code"/>
  <meta property="article:tag" content="article"/>
  <meta property="article:tag" content="excel"/>
  <meta property="article:tag" content="macro"/>
  <meta property="article:tag" content="logs"/>
  <meta property="article:tag" content="formatting"/>
  <meta property="article:tag" content="incident"/>
  <meta property="article:tag" content="response"/>
  <meta property="article:tag" content="ribbon"/>
  <meta property="og:image" content="https://ineed.to/images/fox.png">

  <title>iNeed.to &ndash; Excel Macro Set</title>


</head>
<body >

<aside>
  <div>
    <a href="https://ineed.to/">
      <img src="https://ineed.to/images/fox.png" alt="iNeed.to" title="iNeed.to">
    </a>

    <h1>
      <a href="https://ineed.to/">iNeed.to</a>
    </h1>

    <p>Seeking the wholeness of the integrated person. Technology - Martial Arts - Learning</p>


    <nav>
      <ul class="list">



          <li>
            <a target="_self" href="https://ineed.to/index.html" >Home</a>
          </li>
          <li>
            <a target="_self" href="https://ineed.to/fixmypc/index.html" >theTechRelay.com</a>
          </li>
          <li>
            <a target="_self" href="https://ineed.to/fixmypc/index.html" >iNeed.to/fixmypc</a>
          </li>
          <li>
            <a target="_self" href="https://ineed.to/code/index.html" >iNeed.to/code</a>
          </li>
          <li>
            <a target="_self" href="https://ineed.to/fight/index.html" >iNeed.to/fight</a>
          </li>
          <li>
            <a target="_self" href="https://ineed.to/categories.html" >Categories</a>
          </li>
          <li>
            <a target="_self" href="https://ineed.to/archives.html" >Archives</a>
          </li>
          <li>
            <a target="_self" href="https://ineed.to/tags.html" >All Tags</a>
          </li>
          <li>
            <a target="_self" href="https://ineed.to/about/index.html" >About</a>
          </li>
          <li>
            <a target="_self" href="https://ineed.to/contact/index.html" >Contact</a>
          </li>
      </ul>
    </nav>

    <ul class="social">
      <li>
        <a class="sc-envelope"
rel="me"           href="https://ineed.to/pages/contact.html"
           target="_blank">
          <i class="fa-solid fa-envelope"></i>
        </a>
      </li>
      <li>
        <a class="sc-linkedin"
           href="https://www.linkedin.com/in/vmike/"
           target="_blank">
          <i class="fa-brands fa-linkedin"></i>
        </a>
      </li>
      <li>
        <a class="sc-github"
           href="https://github.com/bitpusher2k"
           target="_blank">
          <i class="fa-brands fa-github"></i>
        </a>
      </li>
      <li>
        <a class="sc-x-twitter"
           href="https://x.com/VinceVulpes/"
           target="_blank">
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      </li>
      <li>
        <a class="sc-discord"
           href="https://discordapp.com/users/370020594353438720"
           target="_blank">
          <i class="fa-brands fa-discord"></i>
        </a>
      </li>
      <li>
        <a class="sc-signal-messenger"
           href="https://signal.me/#eu/fhL_n_BFwvyodTKNGtfle5qfhYds-m04I73nmEuTg5qkzbzphYZNgJgY65JmA-s0"
           target="_blank">
          <i class="fa-brands fa-signal-messenger"></i>
        </a>
      </li>
      <li>
        <a class="sc-mastodon"
rel="me"           href="https://defcon.social/@bitpusher"
           target="_blank">
          <i class="fa-brands fa-mastodon"></i>
        </a>
      </li>
    </ul>
  </div>

</aside>
  <main>


<article class="single">
  <header>
      
    <h1 id="excel-macros">Excel Macro Set</h1>
    <p>
      Posted on 2024-05-20 in <a href="https://ineed.to/category/code.html">Code</a>

    </p>
  </header>


  <div>
    <h1>Spreadsheets - A killer app since 1979</h1>
<p><img alt="The macro ribbon" src="./../images/article-excelmacros-thejob.png" style="width: 1177px; height: auto;"/></p>
<p>I'm no Excel expert, but nonetheless find myself working with the magical grid nearly every day. Very often for my line of work that entails reviewing log files for suspicious activity, finding patterns, and preparing reports based on what I find. after doing the same steps over and over, I finally dug in, assembled a set of macros, and figured out how to add them to the Excel ribbon menu for easy access.</p>
<h2>My Excel Macro Ribbon Set</h2>
<p><img alt="The macro ribbon" src="./../images/article-excelmacros-intro.png" style="width: 1058px; height: auto;"/></p>
<p>You can download the set of <a href="https://github.com/bitpusher2k/ExcelMacros">ExcelMacros on GitHub here</a> and follow the included instructions for adding them to your Excel ribbon. Full installation and configuration information is in the <a href="https://github.com/bitpusher2k/ExcelMacros/blob/main/README.md">readme</a>, and here is a description of what each macro/button in the current version can do for you:</p>
<ul>
<li>Initialize CSV - Applies the next five macros in sequence - Handy for initializing a CSV log file for manual review.</li>
<li>Auto Fit All Columns (50) - Auto-fits all column width with maximum with for each column of 50 characters.</li>
<li>Auto Fit All Rows (50) - Auto-fits all row height with maximum height for each row of 50 characters.</li>
<li>Add Filter - Adds filter to top row. I know this is easy enough to do with the Ctrl+Shift+L shortcut, but this fits in with the flow when using other related macros and the "Initialize CSV" above.</li>
<li>Hide Empty Columns - Hides all columns which have data only in the first row (assumed to be the header row).</li>
<li>Hide GUID Columns - Hide all columns which have a GUID in the second row (the first is assumed to be the header).</li>
<li>Split Date And Time To New Columns - Use only if a column containing date-space-time is selected - Creates two new columns to the right, copies date into the first, and copies time into the second.</li>
<li>Highlight Cells With Selected Value - Highlights all CELLS which contains the value in the currently selected cell. Can then use filter by color to limit view to highlighted entries.</li>
<li>Highlight Rows With Selected Value - Highlights all ROWS that have a cell which contains the value in the currently selected cell. <em>Separate macros for yellow/green/red highlighting included.</em></li>
<li>Blank If Error - Surround formulas in all selected cells with =IFERROR(,"").</li>
<li>Convert Selected To Values - Converts formulas in selected cells to values.</li>
<li>Highlight Duplicate Values Selected Range - Highlights duplicate values in the selected range of cells.</li>
<li>Save Worksheet As PDF - Saves current worksheet as a PDF of the same name in the same folder as the original without any further prompts.</li>
<li>Save Worksheet As XLSX - Saves current worksheet as XLSX with same path &amp; filename as the original open file. Handy when processing CSV files - faster than pressing F12 &gt; clicking Drop-down menu &gt; clicking XLSX &gt; clicking Save.</li>
<li>Clear All Highlighting - Clears all highlighting in the worksheet (in case highlighting went awry with previous macros).</li>
<li>Unhide All Rows Columns - Un-hides all manually hidden columns (and rows, if no filters are applied).</li>
<li>CustomSort - Brings up the custom sort dialog (saves a couple clicks).</li>
<li>Delete Hidden Rows - Deletes all currently hidden rows.</li>
<li>DeleteH idden Columns - Deletes all currently hidden columns.</li>
</ul>
<p><img alt="The macro ribbon in action" src="./../images/article-excelmacros-excel.png" style="width: 2333px; height: auto;"/></p>
<p>Caveat Emptor: These macros are not particularly refined - no error handling, and some edge cases will cause them to fail - but they're good enough to save me a lot of time daily, so they're about as good as they're going to get for now.</p>
<h2>Additional Excel tips</h2>
<p>If you, like me, tend to have multiple spreadsheets open I recommend updating the Registry so that when opening a sheet/CSV by double-clicking it opens Excel in Embedded mode (prevents the default workbook Book.xltx from being created and startup screen from appearing) and opens each sheet/CSV in its own instance of the "Excel.exe" app so that if an operation (function, macro) is fully occupying one instance all of them are not frozen (you can go work on another sheet until the macro finishes). </p>
<p>The changes needed are at least updating "Excel.CSV" and "Excel.Sheet.12":</p>
<ul>
<li>HKEY_CLASSES_ROOT\Excel.Sheet.12\shell\Open\command to "\"C:\Program Files\Microsoft Office\Root\Office16\EXCEL.EXE\" /e \"%1\" /o \"%u\""</li>
<li>HKEY_CLASSES_ROOT\Excel.CSV\shell\Open\command to "\"C:\Program Files\Microsoft Office\Root\Office16\EXCEL.EXE\" /e \"%1\" /o \"%u\""</li>
</ul>
<p><img alt="Read-only" src="./../images/article-excelmacros-reg.png" style="width: 1267px; height: auto;"/></p>
<p>Here are two REG files that can be imported to update these values: </p>
<ul>
<li><a href="https://ineed.to/excel-macros/ExcelCSVopenwithoutotherpopup.reg">ExcelCSVopenwithoutotherpopup.reg</a></li>
<li><a href="https://ineed.to/excel-macros/ExcelSheetopenwithoutotherpopup.reg">ExcelSheetopenwithoutotherpopup.reg</a></li>
</ul>
<p>Then go to %appdata%\Microsoft\Excel\XLSTART, right-click PERSONAL.XLSB and set the file attributes to read-only to prevent a "file in use" popup when multiple instances of Excel are started and each reads the macro file.</p>
<p><img alt="Read-only" src="./../images/article-excelmacros-readonly.png" style="width: 526px; height: auto;"/></p>
<p>Walk on,</p>
<div class="highlight"><pre><span></span><code>Bitpusher
 \`._,'/
 (_- -_)
   \o/
</code></pre></div>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://ineed.to/tag/article.html">article</a>
      <a href="https://ineed.to/tag/excel.html">excel</a>
      <a href="https://ineed.to/tag/macro.html">macro</a>
      <a href="https://ineed.to/tag/logs.html">logs</a>
      <a href="https://ineed.to/tag/formatting.html">formatting</a>
      <a href="https://ineed.to/tag/incident.html">incident</a>
      <a href="https://ineed.to/tag/response.html">response</a>
      <a href="https://ineed.to/tag/ribbon.html">ribbon</a>
    </p>
  </div>






</article>

<footer>
<p>
  &copy; 2025 Bitpusher - the Digital Fox - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nd/4.0/deed.en_US" target="_blank">Creative Commons Attribution-NoDerivs</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script id="dark-theme-script"
          src="https://ineed.to/theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="True"
          data-default-theme="dark"
          type="text/javascript">
  </script>
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-nd/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by-nd/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p><p>
  <script async data-id="101489478" src="//static.getclicky.com/js"></script>
</p></footer>  </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " iNeed.to ",
  "url" : "https://ineed.to",
  "image": "https://ineed.to/images/fox.png",
  "description": "Sharing my passion for technology through consulting & scripting, martial arts through teaching, and learning/growth through chronicling my journey"
}
</script>
</body>
</html>